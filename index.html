<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Scavengr Search</title>
  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,100..700;1,100..700&display=swap"
    rel="stylesheet">
  <script type="module" src="ingredients.js"></script>
</head>

<body>
  <div class="glass-card">
    <h1 style="z-index: 10; font-size: 96px; color: #fff; top: 36%; left: 51%">Scavengr.</h1>
    <svg width="1568" height="848" viewBox="0 0 1568 848" fill="none" xmlns="http://www.w3.org/2000/svg"
      style="z-index: 1">
      <foreignObject x="-46.7" y="-77.7" width="1661.4" height="961.4">
        <div xmlns="http://www.w3.org/1999/xhtml"
          style="backdrop-filter:blur(52.85px);clip-path:url(#bgblur_0_1_5_clip_path);height:100%;width:100%">
        </div>
      </foreignObject>
      <g filter="url(#filter0_di_1_5)" data-figma-bg-blur-radius="105.7">
        <rect x="59" y="28" width="1450" height="750" rx="66" fill="url(#paint0_linear_1_5)" fill-opacity="0.05"
          shape-rendering="crispEdges" />
        <rect x="59.5" y="28.5" width="1449" height="749" rx="65.5" stroke="url(#paint1_linear_1_5)"
          stroke-opacity="0.31" shape-rendering="crispEdges" />
      </g>
      <defs>
        <filter id="filter0_di_1_5" x="-46.7" y="-77.7" width="1661.4" height="961.4" filterUnits="userSpaceOnUse"
          color-interpolation-filters="sRGB">
          <feFlood flood-opacity="0" result="BackgroundImageFix" />
          <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
            result="hardAlpha" />
          <feOffset dy="31" />
          <feGaussianBlur stdDeviation="29.35" />
          <feComposite in2="hardAlpha" operator="out" />
          <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.44 0" />
          <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1_5" />
          <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1_5" result="shape" />
          <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
            result="hardAlpha" />
          <feOffset dy="17" />
          <feGaussianBlur stdDeviation="13.25" />
          <feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1" />
          <feColorMatrix type="matrix" values="0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.25 0" />
          <feBlend mode="normal" in2="shape" result="effect2_innerShadow_1_5" />
        </filter>
        <clipPath id="bgblur_0_1_5_clip_path" transform="translate(46.7 77.7)">
          <rect x="59" y="28" width="1450" height="750" rx="66" />
        </clipPath>
        <linearGradient id="paint0_linear_1_5" x1="784" y1="28" x2="784" y2="778" gradientUnits="userSpaceOnUse">
          <stop stop-color="white" />
          <stop offset="1" stop-color="white" stop-opacity="0.5" />
        </linearGradient>
        <linearGradient id="paint1_linear_1_5" x1="784" y1="28" x2="784" y2="778" gradientUnits="userSpaceOnUse">
          <stop stop-color="white" />
          <stop offset="1" stop-color="white" stop-opacity="0" />
        </linearGradient>
      </defs>
    </svg>
  </div>
  <div class="search-bar">
    <input class="text-input" type="text" id="searchInput" placeholder="Enter ingredients for recipe" style="
        z-index: 3;
        position: absolute;
        top: 48.1%; 
        left: 51%; 
        transform: translate(-50%, -50%);
        width: 600px;
        height: 156px;
        background: transparent;
        border: none;
        color: black;
        font-size: 1.4rem;
        text-align: left;
        font-family: Roboto Mono;
        outline: none" />
    <svg class="search-box" width="792" height="156" viewBox="0 0 792 156" fill="none" style="z-index: 1"
      xmlns="http://www.w3.org/2000/svg">
      <g filter="url(#filter0_d_1_40)">
        <path fill-rule="evenodd" clip-rule="evenodd"
          d="M78 5C57.5655 5 41 21.5655 41 42C41 62.4345 57.5655 79 78 79H714C734.435 79 751 62.4345 751 42C751 21.5655 734.435 5 714 5H78ZM69.9867 30.4352C71.815 29.4923 73.8422 29.0002 75.8993 29C78.3214 28.9998 80.6947 29.6816 82.7475 30.9672C84.8004 32.2528 86.4497 34.0904 87.5069 36.2696C88.5641 38.4488 88.9864 40.8816 88.7254 43.2896C88.4645 45.6976 87.5309 47.9835 86.0314 49.8857L91.574 55.428C91.8504 55.7143 92.0034 56.0976 91.9999 56.4955C91.9965 56.8935 91.8369 57.2741 91.5555 57.5555C91.2741 57.8369 90.8934 57.9965 90.4955 57.9999C90.0976 58.0034 89.7142 57.8504 89.4279 57.574L83.8853 52.0316C82.2697 53.3048 80.373 54.1732 78.3534 54.5644C76.3338 54.9555 74.25 54.8581 72.2758 54.2801C70.3016 53.7022 68.4942 52.6605 67.0045 51.242C65.5147 49.8235 64.3858 48.0693 63.7119 46.1259C63.038 44.1823 62.8387 42.1059 63.1305 40.0697C63.4224 38.0335 64.1969 36.0966 65.3896 34.4206C66.5823 32.7446 68.1585 31.3782 69.9867 30.4352ZM68.9237 34.9245C67.0736 36.7745 66.0343 39.2836 66.0343 41.8999C66.0343 44.5161 67.0736 47.0252 68.9237 48.8752C70.7737 50.7252 73.2829 51.7645 75.8993 51.7645C78.5156 51.7645 81.0248 50.7252 82.8749 48.8752C84.7249 47.0252 85.7643 44.5161 85.7643 41.8999C85.7643 39.2836 84.7249 36.7745 82.8749 34.9245C81.0248 33.0746 78.5156 32.0353 75.8993 32.0353C73.2829 32.0353 70.7737 33.0746 68.9237 34.9245Z"
          fill="white" fill-opacity="0.29" shape-rendering="crispEdges" />
      </g>
      <defs>
        <filter id="filter0_d_1_40" x="0.799999" y="0.799999" width="790.4" height="154.4" filterUnits="userSpaceOnUse"
          color-interpolation-filters="sRGB">
          <feFlood flood-opacity="0" result="BackgroundImageFix" />
          <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
            result="hardAlpha" />
          <feOffset dy="36" />
          <feGaussianBlur stdDeviation="20.1" />
          <feComposite in2="hardAlpha" operator="out" />
          <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0" />
          <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1_40" />
          <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1_40" result="shape" />
        </filter>
      </defs>
    </svg>
  </div>
  <div id="ingredientList" style="position:absolute; top:70%; left:50%; transform:translate(-50%,0%);
       background: rgba(255,255,255,0.8); padding: 1rem; border-radius: 8px;">
    <!-- Ingredient items will be added here -->
  </div>
  <div class="add-preferences">
    <button class="preferences-btn">
      <svg class="preferences-box" width="427" height="156" viewBox="0 0 427 156" fill="none"
        xmlns="http://www.w3.org/2000/svg" style="z-index: 1">
        <g filter="url(#filter0_d_37_110)">
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M78 11C57.5655 11 41 27.5655 41 48C41 68.4345 57.5655 85 78 85H349C369.435 85 386 68.4345 386 48C386 27.5655 369.435 11 349 11H78ZM79.5 34V46.5H92V49.5H79.5V62H76.5V49.5H64V46.5H76.5V34H79.5Z"
            fill="#D9D9D9" fill-opacity="0.29" shape-rendering="crispEdges" />
        </g>
        <defs>
          <filter id="filter0_d_37_110" x="0.799999" y="0.799999" width="425.4" height="154.4"
            filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
            <feFlood flood-opacity="0" result="BackgroundImageFix" />
            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
              result="hardAlpha" />
            <feOffset dy="30" />
            <feGaussianBlur stdDeviation="20.1" />
            <feComposite in2="hardAlpha" operator="out" />
            <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0" />
            <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_37_110" />
            <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_37_110" result="shape" />
          </filter>
        </defs>
        <foreignObject x="1.6%" y="-2%" width="400" height="100" style="font-family: Roboto Mono; color: black;
        font-size: 11;">
            <div xmlns="http://www.w3.org/1999/xhtml" style="pointer-events: none">
                <h1>Add preferences</h1>
            </div>
        </foreignObject>
      </svg>
    </button>
  </div>

  <input type="file" id="imageInput" accept="image/*" style="display:none;">

  <div class="add-image">
    <button class="img-btn" id="imgUploadBtn">
      <svg class="image-box" width="427" height="156" viewBox="0 0 427 156" fill="none"
        xmlns="http://www.w3.org/2000/svg" style="z-index: 1">
        <g filter="url(#filter0_d_37_109)">
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M78 11C57.5655 11 41 27.5655 41 48C41 68.4345 57.5655 85 78 85H349C369.435 85 386 68.4345 386 48C386 27.5655 369.435 11 349 11H78ZM94.0457 29C94.8741 29 95.5457 29.6716 95.5457 30.5V32.9351H97.9808C98.8092 32.9351 99.4808 33.6066 99.4808 34.4351C99.4808 35.2635 98.8092 35.9351 97.9808 35.9351H95.5457V38.3702C95.5457 39.1986 94.8741 39.8702 94.0457 39.8702C93.2173 39.8702 92.5457 39.1986 92.5457 38.3702V35.9351H90.1106C89.2822 35.9351 88.6106 35.2635 88.6106 34.4351C88.6106 33.6066 89.2822 32.9351 90.1106 32.9351H92.5457V30.5C92.5457 29.6716 93.2173 29 94.0457 29ZM65 34.4351C65 33.6066 65.6716 32.9351 66.5 32.9351H84.2079C85.0364 32.9351 85.7079 33.6066 85.7079 34.4351C85.7079 35.2635 85.0364 35.9351 84.2079 35.9351H68V60.4808H92.5457V44.2728C92.5457 43.4444 93.2173 42.7728 94.0457 42.7728C94.8741 42.7728 95.5457 43.4444 95.5457 44.2728V61.9808C95.5457 62.8092 94.8741 63.4808 94.0457 63.4808H66.5C65.6716 63.4808 65 62.8092 65 61.9808V34.4351ZM78.3053 41.7891C78.8322 41.7891 79.3204 42.0656 79.5916 42.5173L80.7647 44.4727L81.446 43.3372C81.7171 42.8854 82.2054 42.6089 82.7323 42.6089C83.2592 42.6089 83.7474 42.8854 84.0186 43.3372L89.4293 52.3551C89.7073 52.8185 89.7146 53.3956 89.4484 53.8659C89.1821 54.3361 88.6835 54.6268 88.1431 54.6268H72.4026C71.8622 54.6268 71.3636 54.3361 71.0974 53.8659C70.8311 53.3956 70.8384 52.8185 71.1164 52.3551L77.019 42.5173C77.2902 42.0656 77.7784 41.7891 78.3053 41.7891ZM75.0519 51.6268H85.4938L82.7323 47.0244L82.051 48.1599C81.7799 48.6117 81.2916 48.8881 80.7647 48.8881C80.2379 48.8881 79.7496 48.6117 79.4785 48.1599L78.3053 46.2046L75.0519 51.6268Z"
            fill="#D9D9D9" fill-opacity="0.29" shape-rendering="crispEdges" />
        </g>
        <defs>
          <filter id="filter0_d_37_109" x="0.799999" y="0.799999" width="425.4" height="154.4"
            filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
            <feFlood flood-opacity="0" result="BackgroundImageFix" />
            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
              result="hardAlpha" />
            <feOffset dy="30" />
            <feGaussianBlur stdDeviation="20.1" />
            <feComposite in2="hardAlpha" operator="out" />
            <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0" />
            <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_37_109" />
            <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_37_109" result="shape" />
          </filter>
        </defs>
        <foreignObject x="-5.5%" y="-2%" width="400" height="100" style="font-family: Roboto Mono; color: black;
            font-size: 11;">
          <div xmlns="http://www.w3.org/1999/xhtml" style="pointer-events: none">
            <h1>Add image</h1>
          </div>
        </foreignObject>
      </svg>
    </button>
  </div>
  
  <script type="module">
    // ===== Universal Ingredient List Code =====
    const ingredientKey = 'campingIngredients';

    function getIngredients() {
      const stored = localStorage.getItem(ingredientKey);
      return stored ? JSON.parse(stored) : [];
    }

    function renderIngredients() {
      const ingredientList = document.getElementById('ingredientList');
      const ingredients = getIngredients();
      ingredientList.innerHTML = '';
      if (ingredients.length === 0) {
        ingredientList.textContent = "No ingredients added yet.";
      } else {
        ingredients.forEach(ingredient => {
          const item = document.createElement('div');
          item.textContent = ingredient;
          ingredientList.appendChild(item);
        });
      }
    }

    function syncInputToStorage() {
      let ingredients = searchInput.value.split(',')
        .map(item => item.trim())
        .filter(Boolean);
      localStorage.setItem(ingredientKey, JSON.stringify(ingredients));
      searchInput.value = ingredients.join(', ');
      renderIngredients();
    }

    // ===== Handling the Search Input =====
    const searchInput = document.getElementById('searchInput');
    searchInput.addEventListener('keydown', (event) => {
      // If Shift+Enter is pressed, switch to recipes.html (results screen)
      if (event.key === 'Enter' && event.shiftKey) {
        event.preventDefault();
        // Make sure to sync any current input first
        syncInputToStorage();
        window.location.href = "recipes.html";
      } else if (event.key === 'Enter') {
        event.preventDefault();
        syncInputToStorage();
      }
    });

    document.addEventListener('DOMContentLoaded', () => {
      const ingredients = getIngredients();
      if (ingredients.length) {
        searchInput.value = ingredients.join(', ');
      }
      renderIngredients();
    });

    // ===== Image Upload Handling =====
    const imgUploadBtn = document.getElementById('imgUploadBtn');
    const imageInput = document.getElementById('imageInput');

    imgUploadBtn.addEventListener('click', () => {
      imageInput.click();
    });

    imageInput.addEventListener('change', async (event) => {
      const file = event.target.files[0];
      if (!file) return;

      const formData = new FormData();
      formData.append('image', file);

      try {
        const response = await fetch('http://127.0.0.1:5000/classify', {
          method: 'POST',
          body: formData,
        });
        const foodName = await response.text();
        let ingredients = searchInput.value.split(',')
          .map(item => item.trim())
          .filter(Boolean);
        if (!ingredients.includes(foodName)) {
          ingredients.push(foodName);
        }
        localStorage.setItem(ingredientKey, JSON.stringify(ingredients));
        searchInput.value = ingredients.join(', ');
        renderIngredients();
      } catch (err) {
        console.error(err);
        alert('Error classifying image.');
      }
    });

    // ===== Preferences Handling =====
    const preferencesBtn = document.querySelector('.preferences-btn');
    preferencesBtn.addEventListener('click', () => {
      const prefs = prompt("Enter your food preferences (e.g. vegetarian, spicy, low-carb):");
      if (prefs !== null) {
        localStorage.setItem('campingPreferences', prefs.trim());
        alert("Preferences saved!");
      }
    });
  </script>
</body>

</html>
<script>
  const shapes = [
    `<svg width="402" height="402" viewBox="0 0 402 402" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="99.5" cy="302.5" r="302.5" fill="url(#paint0_linear_1_6)"/><defs><linearGradient id="paint0_linear_1_6" x1="99.5" y1="0" x2="99.5" y2="605" gradientUnits="userSpaceOnUse"><stop stop-color="#438A64"/><stop offset="1" stop-opacity="0"/></linearGradient></defs></svg>`,
    `<svg width="345" height="420" viewBox="0 0 345 420" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="231.5" cy="188.5" r="231.5" fill="url(#paint0_linear_1_8)"/><defs><linearGradient id="paint0_linear_1_8" x1="231.5" y1="-43" x2="231.5" y2="420" gradientUnits="userSpaceOnUse"><stop stop-color="#43758A"/><stop offset="1" stop-opacity="0"/></linearGradient></defs></svg>`,
    `<svg width="184" height="229" viewBox="0 0 184 229" fill="none" xmlns="http://www.w3.org/2000/svg"> <rect x="-45" y="83.55" width="167.1" height="167.1" transform="rotate(-30 -45 83.55)" fill="url(#paint0_linear_1_7)"/> <defs> <linearGradient id="paint0_linear_1_7" x1="102.863" y1="72.4436" x2="-82.4981" y2="376.499" gradientUnits="userSpaceOnUse"> <stop stop-color="#E27856"/> <stop offset="1" stop-opacity="0"/> </linearGradient> </defs> </svg>`,
    `<svg width="409" height="251" viewBox="0 0 409 251" fill="none" xmlns="http://www.w3.org/2000/svg"> <rect width="408.753" height="408.753" transform="matrix(-0.963943 -0.266109 -0.266109 0.963943 502.788 108.773)" fill="url(#paint0_linear_1_10)"/> <defs> <linearGradient id="paint0_linear_1_10" x1="361.697" y1="-27.1681" x2="106.956" y2="438.5" gradientUnits="userSpaceOnUse"> <stop stop-color="#E2C456"/> <stop offset="1" stop-opacity="0"/> </linearGradient> </defs> </svg>`,
    `<svg width="276" height="177" viewBox="0 0 276 177" fill="none" xmlns="http://www.w3.org/2000/svg"> <rect y="58.2361" width="225.007" height="225.007" transform="rotate(-15 0 58.2361)" fill="url(#paint0_linear_1_19)"/> <defs> <linearGradient id="paint0_linear_1_19" x1="164.791" y1="42.1013" x2="98.5588" y2="295.079" gradientUnits="userSpaceOnUse"> <stop stop-color="#4F5C9F"/> <stop offset="1" stop-opacity="0"/> </linearGradient> </defs> </svg>`,
    `<svg width="319" height="340" viewBox="0 0 319 340" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M-0.00613648 339.324L38.2786 0.346971L318.74 197.19L-0.00613648 339.324Z" fill="url(#paint0_linear_1_12)"/> <defs> <linearGradient id="paint0_linear_1_12" x1="39.633" y1="-0.256993" x2="58.5" y2="551.5" gradientUnits="userSpaceOnUse"> <stop stop-color="#9F78B7"/> <stop offset="1" stop-opacity="0"/> </linearGradient> </defs> </svg>`,
    `<svg width="224" height="218" viewBox="0 0 224 218" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M223.739 0.154586L163.494 217.737L0.633438 59.9357L223.739 0.154586Z" fill="url(#paint0_linear_1_13)"/> <defs> <linearGradient id="paint0_linear_1_13" x1="162.546" y1="217.991" x2="207.545" y2="-144.606" gradientUnits="userSpaceOnUse"> <stop stop-color="#788AB7"/> <stop offset="1" stop-opacity="0"/> </linearGradient> </defs> </svg>`,
    `<svg width="551" height="386" viewBox="0 0 551 386" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M550.326 385.172L362.23 -128.066L0.196385 284.709L550.326 385.172Z" fill="url(#paint0_linear_1_15)"/> <defs> <linearGradient id="paint0_linear_1_15" x1="359.892" y1="-128.493" x2="539.665" y2="737.685" gradientUnits="userSpaceOnUse"> <stop stop-color="#AAAE7A"/> <stop offset="1" stop-opacity="0"/> </linearGradient> </defs> </svg>`,
  ];

  const positionlist = [
    [300, 780],
    [1500, 200],
    [100, 400],
    [1400, 750],
    [1000, 880],
    [1100, 450],
    [650, 610],
    [550, 200],
  ]

  const svgShapes = [];
  shapes.forEach((svg, index) => {
    const container = document.createElement("div");
    container.innerHTML = svg;
    const svgElement = container.firstChild;
    svgElement.style.position = "fixed";
    svgElement.style.left = positionlist[index][0] - 150 + "px";
    svgElement.style.top = positionlist[index][1] - 160 + "px";
    svgElement.style.overflow = "visible";
    svgElement.style.zIndex = "0";
    svgElement.style.transformOrigin = "center";

    applyRandomMovement(svgElement);
    document.body.appendChild(svgElement);
    svgShapes.push(svgElement);
  });

  function applyRandomMovement(svgElement) {
    svgElement.style.animation = '';
    const useRotation = Math.random() > 0.66;
    const duration = 10 + Math.random() * 8;
    const animationName = `anim-${Math.random().toString(36).substr(2, 9)}`;

    if (useRotation) {
      const endRotation = (Math.random() - 0.5) * 100;

      keyframes = `
            @keyframes ${animationName} {
                0%, 100% { transform: rotate(0deg); }
                25% { transform: rotate(${endRotation}deg); }
                50% { transform: rotate(${endRotation + (Math.random() - 0.5) * 60}deg); }
            }
        `;
    } else {

      keyframes = `
            @keyframes ${animationName} {
                0%, 100% { transform: translate(0, 0); }
                33% { transform: translate(${(Math.random() - 0.5) * 130}px, ${(Math.random() - 0.5) * 130}px); }
                66% { transform: translate(${(Math.random() - 0.5) * 130}px, ${(Math.random() - 0.5) * 130}px); }
            }
        `;
    }

    const style = document.createElement('style');
    style.innerHTML = keyframes;
    document.head.appendChild(style);
    svgElement.style.animation = `${animationName} ${duration}s ease-in-out 1`;

    const onAnimationEnd = () => {
      svgElement.removeEventListener('animationend', onAnimationEnd);
      document.head.removeChild(style);
      applyRandomMovement(svgElement);
    };

    svgElement.addEventListener('animationend', onAnimationEnd);
  }
</script>